#!/bin/bash

# ๐ ะกะบัะธะฟั ะฐะฒัะพะผะฐัะธัะตัะบะพะณะพ ะพะฑะฝะพะฒะปะตะฝะธั Aero Lunch
set -e

echo "๐ ะะฐัะธะฝะฐะตะผ ะฐะฒัะพะผะฐัะธัะตัะบะพะต ะพะฑะฝะพะฒะปะตะฝะธะต..."

# ะะฑะฝะพะฒะปัะตะผ ะบะพะด
echo "๐ฅ ะะฑะฝะพะฒะปัะตะผ ะบะพะด..."
git pull origin main

# ะะฑะฝะพะฒะปัะตะผ ะทะฐะฒะธัะธะผะพััะธ ะธ ะฟะตัะตัะพะฑะธัะฐะตะผ ััะพะฝัะตะฝะด
echo "๐ฆ ะะฑะฝะพะฒะปัะตะผ ะทะฐะฒะธัะธะผะพััะธ..."
npm install

echo "๐จ ะะะะะฃะะะขะะะฌะะ ะฟะตัะตัะพะฑะธัะฐะตะผ ััะพะฝัะตะฝะด..."
npm run build

echo "๐ ะะพะฟะธััะตะผ ัะฐะนะปั ะฒ nginx..."
sudo cp -r dist/* /usr/share/nginx/html/

# ะะฑะฝะพะฒะปัะตะผ ะฑัะบะตะฝะด
echo "๐ง ะะฑะฝะพะฒะปัะตะผ ะฑัะบะตะฝะด..."
cd server
npm install

echo "๐ ะะตัะตะทะฐะฟััะบะฐะตะผ ัะตัะฒะธั..."
sudo systemctl restart aero-lunch-backend

echo "โ ะัะพะฒะตััะตะผ ััะฐััั..."
sudo systemctl status aero-lunch-backend --no-pager

echo "๐ ะะฑะฝะพะฒะปะตะฝะธะต ะทะฐะฒะตััะตะฝะพ!" 